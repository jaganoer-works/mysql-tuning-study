# MySQL パフォーマンスチューニング習得カリキュラム

## 前提・対象者
- **期間**: 3ヶ月（週末2-3時間 × 12週）
- **環境**: Docker Compose を使った実践的な学習
- **目標**: 実務で即戦力となるMySQLパフォーマンスチューニングスキルの習得

---

## 📚 カリキュラム構成

### Phase 1: 基盤構築と現状把握（Week 1-3）
### Phase 2: 基本的なチューニング技術（Week 4-6）
### Phase 3: 高度なチューニング技術（Week 7-9）
### Phase 4: 実践的なシナリオ対応（Week 10-12）

---

## 🐳 Week 1: Docker環境構築とベンチマーク環境準備

### 目標
- [x] パフォーマンステスト用のMySQL環境構築
- [x] ベンチマークツールの準備
- [x] 監視環境の構築

### 学習内容
- [x] Docker Composeでの複数MySQL環境構築（本番想定）
- [x] Prometheus + Grafana監視環境セットアップ
- [x] 大量テストデータ生成（100万レコード規模）
- [x] sysbench導入とベースライン計測
- [ ] phpMyAdmin、Adminer等管理ツール設定(今回はスキップ)

### 週末課題
- [x] 100万レコードのテストデータ生成
- [x] sysbenchでのベースライン計測
- [x] Grafanaダッシュボードでのメトリクス可視化

---

## 📊 Week 2: パフォーマンス監視と測定基盤

### 目標
- クエリパフォーマンスの計測方法習得
- スロークエリログの分析
- EXPLAIN文の読み方マスター

### 学習内容
- スロークエリログ設定と pt-query-digest 分析
- EXPLAIN、EXPLAIN ANALYZE、EXPLAIN FORMAT=JSON の使い分け
- Performance Schema活用法
- information_schema からの統計情報取得
- クエリ実行時間とリソース使用量の計測手法

### 週末課題
- 意図的にスロークエリを作成し分析
- 複雑なJOINクエリのEXPLAIN分析
- Performance Schemaでのボトルネック特定

---

## 🔍 Week 3: インデックス設計の基礎と応用

### 目標
- インデックスの種類と特性理解
- 効果的なインデックス設計
- インデックス最適化の実践

### 学習内容
- B-Tree、Hash、Fulltext、空間インデックスの特性
- 単一インデックス vs 複合インデックス戦略
- カーディナリティとセレクティビティ分析
- インデックスヒント使用法
- 部分インデックス、関数インデックス（MySQL 8.0）
- インデックス統計とメンテナンス

### 週末課題
- 10種類のクエリパターンに対する最適インデックス設計
- カーディナリティ分析とインデックス効率計算
- インデックス追加前後のベンチマーク比較

---

## ⚙️ Week 4: MySQL設定パラメータチューニング

### 目標
- 主要設定パラメータの理解
- メモリ設定の最適化
- I/O設定の調整

### 学習内容
- InnoDB Buffer Pool最適化
- ログファイル設定（innodb_log_file_size等）
- 接続・スレッド管理パラメータ
- I/O関連設定（innodb_flush_method等）
- メモリ使用量監視と調整
- 設定変更時の安全な手順

### 週末課題
- 異なるメモリ設定でのベンチマーク比較
- I/O設定調整による効果測定
- 設定変更時の安全な手順確立

---

## 🚀 Week 5: クエリ最適化テクニック

### 目標
- JOINの最適化
- サブクエリの書き換え
- クエリリライティング技術

### 学習内容
- INNER JOIN vs EXISTS vs IN のパフォーマンス比較
- 相関サブクエリの最適化手法
- Window関数活用による高速化
- UNION vs UNION ALL の使い分け
- LIMIT句とORDER BYの効率化
- クエリ実行プランの読み解き

### 週末課題
- 10パターンのクエリ最適化実践
- JOIN vs EXISTS vs IN の性能比較
- Window関数を使ったランキングクエリの作成

---

## 💾 Week 6: ストレージエンジンとテーブル設計

### 目標
- InnoDB詳細設定
- テーブル分割技術
- データ型最適化

### 学習内容
- InnoDB行フォーマット（COMPACT、DYNAMIC等）
- パーティション設計（RANGE、HASH、LIST）
- データ型選択によるストレージ最適化
- テーブルスペース管理
- 行レベルロックとMVCC理解
- AUTO_INCREMENT最適化

### 週末課題
- パーティション設計によるクエリ性能向上測定
- データ型変更による容量削減効果検証
- 大量データでのInnoDB設定調整

---

## 🎯 Week 7: 高負荷対応とスケーリング

### 目標
- レプリケーション設定
- 読み書き分離
- 接続プール最適化

### 学習内容
- Master-Slave レプリケーション構築
- 読み書き分離実装（Laravel設定含む）
- レプリケーションラグ監視
- ProxySQL導入検討
- 接続プール設定とコネクション管理
- 負荷分散戦略

### 週末課題
- レプリケーションラグ監視システム構築
- 読み書き分離での負荷分散効果測定
- 接続プール設定による同時接続数向上

---

## 🔧 Week 8: 障害対応とトラブルシューティング

### 目標
- デッドロック解析と対策
- ロック待機対応
- パフォーマンス劣化原因の特定

### 学習内容
- デッドロック発生パターンと対策
- ロック監視とタイムアウト設定
- 長時間実行クエリの特定と対処
- メモリ不足、ディスク容量問題への対応
- 自動監視・アラートシステム構築
- 障害時の緊急対応手順

### 週末課題
- デッドロック回避策の実装と検証
- ロック監視アラートシステム構築
- 障害シミュレーションと対応手順確立

---

## 🧠 Week 9: 高度なチューニング技術

### 目標
- クエリキャッシュ代替手法
- メモリテーブル活用
- カスタム関数最適化

### 学習内容
- Redis/Memcachedによるアプリケーションレベルキャッシュ
- MEMORYエンジンテーブル活用法
- ストアドプロシージャ vs アプリケーションロジック
- 一時テーブル最適化
- バッチ処理効率化
- カスタム変数活用

### 週末課題
- Redis キャッシュ導入によるクエリ高速化検証
- MEMORYエンジンでの一時テーブル活用実践
- ストアドプロシージャの性能比較測定

---

## 🌟 Week 10: 実践シナリオ1 - ECサイト最適化

### 目標
- 実際のECサイトを想定した最適化
- 商品検索の高速化
- 在庫管理の効率化

### 学習内容
- 商品カタログテーブル設計最適化
- 全文検索インデックス活用
- 階層カテゴリ（Nested Set Model）
- 在庫管理の排他制御
- 商品レビュー集計最適化
- 検索フィルタリング高速化

### 週末課題
- 10万商品のECサイトテストデータ作成
- 商品検索クエリの最適化と性能測定
- 在庫管理の並行処理テスト

---

## 📊 Week 11: 実践シナリオ2 - ログ分析システム

### 目標
- 大量ログデータの効率的な処理
- 時系列データの最適化
- リアルタイム集計の実装

### 学習内容
- 時系列データのパーティション戦略
- ログテーブル設計パターン
- 集計テーブル（プリコンピューテーション）
- バルクインサート最適化
- データアーカイブ戦略
- リアルタイム分析クエリ

### 週末課題
- 100万レコードのログデータ生成と分析
- パーティション効果の検証
- リアルタイム集計システムの構築

---

## 🎓 Week 12: 総合演習と実戦投入準備

### 目標
- 総合的なパフォーマンス診断
- 本番環境移行準備
- 監視・運用体制構築

### 学習内容
- 包括的パフォーマンス診断手法
- 未使用インデックス検出
- 容量増加予測とアーカイブ戦略
- 本番環境デプロイメント計画
- 運用監視ダッシュボード構築
- パフォーマンス劣化の早期検知システム

### 最終課題
- 3ヶ月の学習内容を活用した総合パフォーマンス改善プロジェクト
- 実務想定シナリオでの問題解決
- チューニング結果レポート作成

---

## 📈 習得スキルと実務応用

### 習得できるスキル
- **監視・分析**: スロークエリ分析、パフォーマンス監視、ボトルネック特定
- **チューニング**: インデックス最適化、設定パラメータ調整、クエリ最適化
- **スケーリング**: レプリケーション、読み書き分離、負荷分散
- **障害対応**: デッドロック対策、ロック監視、緊急時対応
- **設計**: テーブル設計、パーティション、データ型最適化

### 実務での価値
- **現職での価値向上**: バッチ処理効率化経験 + DB最適化スキル
- **転職市場価値**: DBA的スキルを持つアプリケーションエンジニア
- **Sun terras等での差別化**: PHP経験 + 高度なDB設計・最適化能力
- **コスト削減**: サーバーリソース使用量削減、レスポンス時間改善

---

## 🔧 学習環境詳細

### 必要な環境
- **Docker Desktop** (Windows/Mac) または Docker Engine (Linux)
- **RAM**: 最低8GB、推奨16GB以上
- **ストレージ**: 20GB以上の空き容量
- **CPU**: 4コア以上推奨

### 使用ツール
- **MySQL**: 8.0系（最新安定版）
- **監視**: Prometheus + Grafana + MySQL Exporter
- **ベンチマーク**: sysbench、mysqlslap
- **分析**: pt-query-digest、MySQL Workbench
- **キャッシュ**: Redis（Week 9で導入）

### 学習スタイル
- **段階的習得**: 基礎→応用→実践の3段階
- **実践重視**: 理論より実際の環境での検証
- **現実的シナリオ**: ECサイト、ログ分析等の実務想定
- **成果測定**: 各週でベンチマーク結果による効果検証

---

## ✅ 成功指標

### Week 4終了時点
- MySQL設定変更によるベンチマーク20%向上
- スロークエリ特定と基本的な最適化実行

### Week 8終了時点  
- インデックス最適化によるクエリ50%高速化
- レプリケーション環境での負荷分散実現

### Week 12終了時点
- 総合的なパフォーマンス改善プロジェクト完了
- 実務レベルのMySQL最適化スキル習得 